# 类型系统
## 命名类型、未命名类型、底层类型
命名类型指的是类型可以用标识符来表示，包含 20 个预声明类型和用户自定义类型。  
未命名类型也称为类型字面量。一般而言，这些基本都是复合类型，如 map, 数组，切片等。  
底层类型：预声明类型和类型字面量（未命名类型）的底层类型是他们本身。自定义类型则需要逐层递归查找。

这里添加一个便于理解的例子。
```go
*int, []int, map[string]int 都是未命名类型，也叫作类型字面量
而 type Map map[string]int, type IntPoint ×int 定义之后，Map和 IntPoint 都是命名类型中的用户自定义类型。
```

## 类型赋值
命名类型与非命名类型一定不相同，而满足下列两个条件时类型相同。
+ 命名类型的类型声明语句相同时
+ 未命名类型的类型字面量结构与内部元素类型相同时

当 a 是类型 T1.赋值 `var b T2 = a` 合法的情况是：
+ T1 与 T2 的类型相同
+ T1, T2 有相同的底层类型，且其中至少有一个是未命名类型

## 类型方法
使用如下方式定义一个命名方法：
```go
func (t TypeName) MethodName(ParamList) (ReturnList) {}
func (t *TypeName) MethodName(ParamList) (ReturnList) {}
```
Go语言的类型方法本质上就是一个函数，显示传递了对象实例或指针且可以自己命名，而不是像C++那样用this指针。  
只能为同一个包中的命名类型增加方法，所以不能为未命名类型和内置预定义类型增加方法。  
使用 type 定义的新类型不能调用原有类型的方法，但是底层类型支持的运算可以被新类型继承
```go
// 下面的 Map 可使用底层支持的运算 range
type Map map[string]int
func (m Map) MethodName() {
    for index, key := range m {
        .....
    }
}
```

## 组合
命名结构类型可以嵌套其他命名字段，在Go中，叫做组合而不是继承，是 "has a" 关系而不是 “is a”关系。
### 一般组合
直接将其他的类型作为自己的内部命名成员
```go
type Wifi struct {
    Name string
}

type Phone struct {
     WifiMdl Wifi
}
```
### 匿名组合
匿名组合也可以叫做内嵌一个类型。

> 当我们嵌入一个类型，这个类型的方法就变成了外部类型的方法，但是当它被调用时，方法的接受者是内部类型(嵌入类型)，而非外部类型。

内部类型的成员名可理解为内部类型名，在外部类型未定义相同名称的属性和方法时，内部方法可提升为外部类型的属性和方法，但实际上，属性和方法的所有者和调用的接受仍然为内部类型。

```go
type Wifi struct {
    Name string
}

type Phone struct {
     Wifi
}
可以使用 Phone 对象直接调用 Wifi 的方法。  
```

需要注意的是， 外层可以定义和内嵌字段方法同名的方法，使得 struct 能够重写内嵌字段的方法。

