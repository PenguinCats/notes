# 面试题没想出来的题目

1. bin log 有几种模式？里面存的是什么？

   + bin log 主要用于主从复制和辅助数据恢复。
   + bin log 的刷盘时机是：
     + 0：不去强制要求，由系统自行判断何时写入磁盘
     + 1：每次 commit 的时候都要将 binlog 写入磁盘【现在的默认设置】
     + N：每N个事务，才会将 binlog 写入磁盘
   + bin log 有三种模式：
     + Statement：包含产生数据变化的 **SQL 语句**
       + 【优】产生的日志文件少， IO 次数少
       + 【劣】在一些**不安全的语句上**，主从复制做不到数据一致，比如
         + 含有系统函数的语句，可能会在副本上返回不同的值，如 `RAND(), USER(),UUID(), SYSDATE() ....`（尤其是涉及到日期，从机上和主机上操作很容易出现不一致）
         + ...
       + 慢 SQL 会在副本中再执行一次
     + Row：**描述单个行的变化**【Default】
       + 【优】这是最安全的复制形式
       + 【优】不会出现某些特定情况下的存储过程，或 function，以及 trigger 的调用和触发无法被正确复制的问题
       + 【优】在 `INSERT/UPDATE/DELETE` 语句中，副本相对主行锁范围更小
       + 【劣】`RBL` 日志文件更大，比如一条update语句，如修改多条记录，则每一条修改都会有记录
     + Mixed：上述两者结合使用
       + 一般的语句修改使用 statment 格式保存 binlog
       + 一些函数，statement 等若是无法满足主从复制的需求，则采用 row 格式保存 binlog